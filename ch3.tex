\documentclass[t]{beamer}

%\documentclass[handout, t]{beamer}
\setbeamertemplate{navigation symbols}{}

 
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsmath}
\usepackage{multicol}

\usepackage{bm}
\usepackage[UTF8]{ctex}
\usetheme{AnnArbor}
\usefonttheme{serif}
\useinnertheme{rounded}
%\usecolortheme{crane}
\setbeamertemplate{blocks}[rounded][shadow=true]

\usepackage{graphicx}

\setmainfont{Times New Roman}
\setCJKmainfont{Microsoft YaHei}
\usepackage{tikz}
\usetikzlibrary{arrows, decorations.pathmorphing, backgrounds, positioning, fit, petri, automata}
\tikzset{>=stealth}

\hypersetup{pdfpagemode=FullScreen}
\renewcommand{\Pr}{\mathbb{P}}
\newcommand{\E}{\mathbb{E}}

\usepackage{blkarray}


\setbeamercolor{block title}{bg=red!10!white}
\setbeamercolor{block body}{bg=gray!5!white}

\newcommand{\dif}{{\;\rm d}}

\usepackage{listings}


\lstset{
  language=Python, % è®¾ç½®è¯­è¨€
  basicstyle=\ttfamily, % è®¾ç½®å­—ä½“æ—
  breaklines=true, % è‡ªåŠ¨æ¢è¡Œ
  keywordstyle=\bfseries\color{blue}, % è®¾ç½®å…³é”®å­—
  ndkeywordstyle=\bfseries\color{blue}, % è®¾ç½®å…³é”®å­—
  classoffset=0,
  emph=[0]{self, plt, pd, np, print, sm, sns, stats, plot_acf,plot_pacf, adfuller,acorr_ljungbox, True, False, None, diff, heatmap}, % æŒ‡å®šå¼ºè°ƒè¯ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œç”¨é€—å·éš”å¼€
  emphstyle=\bfseries\color{magenta!90!black}, % å¼ºè°ƒè¯æ ·å¼è®¾ç½®
  classoffset=1,
  moreemph=[1]{plot, text, title, show, scatter, as, figure, xlabel, ylabel, fit, mean, var, skew, kurt, distplot,rcParams, std, isf, summary,predict,cov,corr, cumprod, mul, repeat}, % è®¾ç½®æ›´å¤šçš„å…³é”®å­—ï¼Œç”¨é€—å·åˆ†éš”
  emphstyle=\bfseries\color{blue}, % å¼ºè°ƒè¯æ ·å¼è®¾ç½®
  classoffset=0,
  commentstyle=\itshape\color{gray}, % è®¾ç½®æ³¨é‡Šæ ·å¼ï¼Œæ–œä½“ï¼Œæµ…ç°è‰²
  stringstyle=\bfseries\color{green!50!black}, % è®¾ç½®å­—ç¬¦ä¸²æ ·å¼
  columns=flexible,
  numberstyle=\footnotesize, % ç¼©å°è¡Œå·
}

\begin{document}
\fontsize{11}{18}\selectfont


\CTEXindent


\title{ç¬¬ä¸‰ç« ~~è¯åˆ¸ä¸šæ•°æ®åˆ†æ}

\author{ä¸»è®²ï¼šæ–¹æ°ã€æçƒœ}
\date{ç¦å»ºæ±Ÿå¤å­¦é™¢é‡‘èå­¦é™¢}

\maketitle

\begin{frame}[fragile]{æœ¬ç« å†…å®¹}
\begin{multicols*}{2}
    \tableofcontents
    
\end{multicols*}

\end{frame}


\section{æ”¶ç›Šç‡æè¿°æ€§ç»Ÿè®¡åˆ†æ}
\subsection{æ”¶ç›Šç‡çš„ç»Ÿè®¡ç‰¹å¾}


\begin{frame}[fragile]{æ”¶ç›Šç‡çš„ç»Ÿè®¡ç‰¹å¾}
\begin{enumerate}
    \item æœŸæœ›æ”¶ç›Šï¼ˆå‡å€¼ï¼‰ ï¼šå‡å€¼æ˜¯ç»Ÿè®¡ä¸­ç”¨äºæè¿°æ•°æ®é›†ä¸­ä½ç½®çš„ç»Ÿè®¡é‡ã€‚
    æ˜¯æè¿°é›†ä¸­è¶‹åŠ¿ç»Ÿè®¡ç‰¹å¾ä¸­æœ€å…·ä»£è¡¨æ€§çš„æ•°å€¼
    \item  é£é™©ï¼ˆæ–¹å·®ï¼‰ ï¼šæ–¹å·®åœ¨ç»Ÿè®¡å­¦ä¸­æ˜¯ç”¨äºè¡¡é‡ä¸€ç»„
    æ•°æ®ç¦»æ•£ç¨‹åº¦çš„ç»Ÿè®¡é‡ï¼Œå®ƒæè¿°
    äº†ä¸€ç»„æ•°æ®å¯¹å…¶å‡å€¼çš„åç¦»ç¨‹åº¦
    \item   å³°åº¦å’Œååº¦ï¼šååº¦åˆç§°åæ€æˆ–åæ€ç³»æ•°ï¼Œæ˜¯ç”¨äºè¡¡é‡æ•°æ®åˆ†å¸ƒéå¯¹ç§°æ€§çš„æ•°å­—ç‰¹å¾ï¼›å³°åº¦æ˜¯è¡¡é‡æ•°æ®
    ç¦»ç¾¤åº¦çš„æŒ‡æ ‡ï¼Œä¹Ÿæ˜¯å¯¹æ¦‚ç‡åˆ†å¸ƒå½¢çŠ¶çš„åˆ»ç”»
\end{enumerate}
\end{frame}




\begin{frame}[fragile]{æœŸæœ›æ”¶ç›Šï¼ˆå‡å€¼ï¼‰}
    åœ¨Pythonçš„pandasåº“ä¸­ï¼Œæ±‚å‡å€¼çš„å‡½æ•°ä¸º\verb|mean|
\begin{lstlisting}
    df.mean(axis=0)
\end{lstlisting}

é»˜è®¤å¯¹å„åˆ—æ±‚å‡å€¼ï¼Œ\verb|axis=1|è¡¨ç¤ºå¯¹å„è¡Œæ±‚å‡å€¼ã€‚
\begin{block}{ä¸¾ä¾‹ï¼š}
    \begin{lstlisting}
import pandas as pd 
#å¯¼å…¥æ²ªæ·±300æ—¥æ”¶ç›Šç‡æ•°æ®
csi300_returns = pd.read_excel('æ–‡ä»¶è·¯å¾„', index_col=0) 
csi300_means = csi300_returns.mean()     # è®¡ç®—æ—¥æ”¶ç›Šç‡
print('æ—¥å¹³å‡æ”¶ç›Šç‡ï¼š', csi300_means)
\end{lstlisting}
\end{block}
\end{frame}


\begin{frame}[fragile]{é£é™©ï¼ˆæ–¹å·®ï¼‰}
\begin{lstlisting}
    df.var(axis=0, skipna=True)
\end{lstlisting}
\begin{itemize}
    \item é»˜è®¤å¯¹å„åˆ—æ±‚æ–¹å·®ï¼Œ\verb|axis=1|è¡¨ç¤ºå¯¹å„è¡Œæ±‚æ–¹å·®
    \item \verb|skipna| é»˜è®¤æ’é™¤ç©ºå€¼
\end{itemize}
\begin{block}{ä¸¾ä¾‹ï¼š}
    \begin{lstlisting}
import pandas as pd
# csi300_returnsä¸ºæ²ªæ·±300æ—¥æ”¶ç›Šç‡æ•°æ®
csi300_vars=csi300_returns.var() 
print( 'æ”¶ç›Šç‡çš„æ–¹å·®ï¼š', csi300_vars)
\end{lstlisting}
\end{block}
\end{frame}



\begin{frame}[fragile]{ååº¦}
    ååº¦ï¼ˆSkewnessï¼‰åˆç§°åæ€æˆ–åæ€ç³»æ•°ï¼Œæ˜¯ç”¨äºè¡¡é‡æ•°æ®åˆ†å¸ƒéå¯¹ç§°æ€§çš„æ•°å­—ç‰¹å¾
\[{\rm Skew}=\E\left[\left(\frac{r-\mu}{\sigma}\right)^3\right]=\frac{\E[(r-\mu)^3]}{\sigma^3} \]
\begin{lstlisting}
    df.skew(axis=0, skipna=True)
\end{lstlisting}
\begin{itemize}
    \item ååº¦${\rm Skew}<0$ï¼šå‘ˆç°å·¦å
    \item ååº¦${\rm Skew}>0$ï¼šå‘ˆç°å³å
    \item ååº¦${\rm Skew}=0$ï¼šåˆ†å¸ƒç›¸å¯¹å‡åŒ€
\end{itemize}
\end{frame}


\begin{frame}[fragile]{å³°åº¦}
å³°åº¦ï¼ˆKurtosisï¼‰æ˜¯è¡¡é‡æ•°æ®
ç¦»ç¾¤åº¦çš„æŒ‡æ ‡ï¼Œä¹Ÿæ˜¯å¯¹æ¦‚ç‡åˆ†
å¸ƒå½¢çŠ¶çš„åˆ»ç”»ã€‚
\[{\rm Kurt}=\E\left[\left(\frac{r-\mu}{\sigma}\right)^4\right]=\frac{\E[(r-\mu)^4]}{\sigma^4} \]

\begin{lstlisting}
    df.kurt(axis=0, skipna=True)
\end{lstlisting}

\begin{itemize}
    \item å³°åº¦${\rm Kurt}=3$ï¼Œæ­¤æ—¶æ˜¯æ­£æ€åˆ†å¸ƒï¼Œä¹Ÿç§°ä¸ºå¸¸å³°æ€
    \item å³°åº¦${\rm Kurt}>3$ï¼Œå°–å³°æ€ï¼Œç›¸è¾ƒäºæ­£æ€åˆ†å¸ƒè€Œè¨€å…·æœ‰
    è¾ƒé«˜çš„å³°éƒ¨å’Œæ›´é•¿çš„å°¾éƒ¨
    \item å³°åº¦${\rm Kurt}<3$ï¼Œä½å³°æ€ï¼Œç›¸è¾ƒäºæ­£æ€åˆ†å¸ƒè€Œè¨€å…·æœ‰è¾ƒ
    å¹³å¦çš„å³°éƒ¨å’Œæ›´çŸ­æ›´ç»†çš„å°¾éƒ¨
\end{itemize}
\end{frame}


\begin{frame}[fragile]{å³°åº¦å’Œæ–¹å·®ä¹‹é—´çš„å…³ç³»}
å³°åº¦å’Œæ–¹å·®ä¹‹é—´çš„å…³ç³»ç´§å¯†ï¼ŒåŒºåˆ«å¾®å¦™ã€‚

å³°åº¦å’Œæ–¹å·®çš„ä¸åŒåœ¨äºï¼Œæ–¹å·®è¡¡é‡äº†éšæœºå˜
é‡åç¦»å‡å€¼çš„åˆ†å¸ƒçŠ¶å†µï¼Œè€Œå³°åº¦è¡¡é‡äº†éšæœºå˜é‡å¤§å¹…åç¦»å‡å€¼çš„å¯èƒ½æ€§ã€‚
\begin{itemize}
    \item æ–¹å·®è¾ƒå¤§ï¼Œæ„å‘³ç€éšæœºå˜é‡åˆ†å¸ƒè¾ƒä¸ºåˆ†æ•£ï¼Œå¹¶æ²¡æœ‰èšé›†åœ¨å‡å€¼é™„è¿‘ã€‚
    \item åœ¨ç»™å®šæ–¹å·®æƒ…å†µä¸‹ï¼Œå³°åº¦å€¼
è¾ƒå¤§æ„å‘³ç€æ–¹å·®è´¡çŒ®ä¸»è¦æ˜¯æ¥è‡ªå°‘æ•°çš„æå€¼ï¼Œè€Œä¸æ˜¯
åç¦»ç¨‹åº¦è¾ƒä¸ºæ¸©å’Œçš„æ•°å€¼ã€‚
\end{itemize}
\end{frame}


\subsection{æ”¶ç›Šç‡çš„åˆ†å¸ƒç‰¹å¾}

\begin{frame}[fragile]{æ­£æ€åˆ†å¸ƒ}
\begin{center}
    \begin{tikzpicture}[yscale=1.3]
\draw[<->, thick, color=cyan](1.414,.45)--node[fill=white]{68.3\%}(-1.414,.45);
\draw[<->, thick, color=red](1.414*2,.85)--node[fill=white]{95.4\%}(-1.414*2,.85);
\draw[<->, thick, color=magenta](1.414*3,2.5)--node[fill=white]{99.7\%}(-1.414*3,2.5);
\draw[dashed](0,0)node[below]{$\mu$}--(0,2);
\draw(-5,0)--(5,0);
\draw[domain=-5:5, samples=100, very thick, color=blue] plot(\x, {2*exp(-.5*\x*\x)});

\draw[dashed](1.414,0)node[below]{$\mu+\sigma$}--(1.414,1);
\draw[dashed](2.828,0)node[below]{$\mu+2\sigma$}--(2.828,1);
\draw[dashed](-1.414,0)node[below]{$\mu-\sigma$}--(-1.414,1);
\draw[dashed](-2.828,0)node[below]{$\mu-2\sigma$}--(-2.828,1);
\draw[dashed](4.243,0)node[below]{$\mu+3\sigma$}--(4.243,2.75);
\draw[dashed](-4.243,0)node[below]{$\mu-3\sigma$}--(-4.243,2.75);

    \end{tikzpicture}
\end{center}

æ­£æ€åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼ˆCumulative Distribution Function, CDFï¼‰çš„å…¬å¼å¦‚ä¸‹ï¼š
\[F(x)=\frac{1}{\sqrt{2\pi}\sigma}\int^x_{-\infty}\exp\left[-\frac{(t-\mu)^2}{2\sigma^2}\right]{\rm d} t \]

%æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆProbability Density Function, PDFï¼‰çš„å…¬å¼å¦‚ä¸‹ï¼š
% \[f(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp\left[-\frac{(x-\mu)^2}{2\sigma^2}\right] \]
% å¯¹åº”çš„
\end{frame}



\begin{frame}[fragile]{æ­£æ€åˆ†å¸ƒ(cont.)}
å½“å‡å€¼$\mu=0$ï¼Œæ–¹å·®$\sigma=1$æ—¶ï¼Œæ­£æ€åˆ†å¸ƒç§°ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒ
\[X\sim \mathcal{N}(\mu,\sigma^2),\qquad Z=\frac{X-\mu}{\sigma}\sim  \mathcal{N}(0,1)\]

æ­£æ€åˆ†å¸ƒå…·æœ‰å¾ˆå¤šè‰¯å¥½çš„ç‰¹æ€§ï¼Œè®¸å¤šæ¦‚ç‡åˆ†å¸ƒå¯ä»¥ç”¨å®ƒæ¥è¿‘ä¼¼ï¼Œå› æ­¤å¤šæ•°æƒ…å†µä¸‹å¯¹å˜é‡è¿›è¡Œç ”ç©¶çš„æ—¶å€™ï¼Œå¾€å¾€å…ˆå‡è®¾è¯¥å˜é‡çš„æ¦‚ç‡åˆ†å¸ƒä¸ºæ­£æ€åˆ†å¸ƒ

\end{frame}

\begin{frame}[fragile]{æ­£æ€åˆ†å¸ƒçš„ç›´è§‚è§‚æµ‹}
è¦å¾—çŸ¥ä¸€ç»„æ•°æ®æ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒï¼Œç®€å•çš„æ–¹æ³•æ˜¯ç»˜åˆ¶ç›´æ–¹å›¾(histogram)æ¥ç›´è§‚åœ°è§‚æµ‹ã€‚

\begin{lstlisting}
    import seaborn as sns
    sns.distplot(a, hist=True, kde=True, label=None)
\end{lstlisting}
\begin{itemize}
    \item \verb|seaborn| æ˜¯åŸºäº Python ä¸”éå¸¸å—æ¬¢è¿çš„å›¾å½¢å¯è§†åŒ–åº“
    \item \verb|a| æ˜¯å¾…åˆ†æçš„ä¸€ç»´æ•°ç»„å˜é‡
    \item \verb|hist| é»˜è®¤æ˜¾ç¤ºä¸ºæ¡å½¢å›¾
    \item \verb|kde| é»˜è®¤ç›´æ–¹å›¾é«˜åº¦æ˜¾ç¤ºä¸ºå¯†åº¦è€Œéè®¡æ•°
    \item \verb|label| æ§åˆ¶å›¾åƒä¸­çš„å›¾ä¾‹æ ‡ç­¾æ˜¾ç¤ºå†…å®¹ï¼Œåªèƒ½æ˜¾ç¤ºè‹±æ–‡å½¢å¼
\end{itemize}
\end{frame}



\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šæ²ªæ·±300æŒ‡æ•°çš„æ—¥æ”¶ç›Šç‡æ•°æ®ç›´æ–¹å›¾ç»˜åˆ¶}
\begin{lstlisting}
import seaborn as sns
import matplotlib.pyplot as plt
plt.rcParams['axes.unicode_minus'] = False
# è§£å†³è´Ÿå·æ— æ³•æ­£å¸¸æ˜¾ç¤ºçš„é—®é¢˜
sns.set(font='SimHei', style='white')
# è§£å†³ä¸­æ–‡æ— æ³•æ­£å¸¸æ˜¾ç¤ºçš„é—®é¢˜ï¼Œè¿™é‡Œä½¿ç”¨é»‘ä½“å­—
sns.distplot(csi300_returns)
plt.xlabel('æ”¶ç›Šç‡')
plt.ylabel('æ¦‚ç‡å¯†åº¦')
plt.show()
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{æ­£æ€åˆ†å¸ƒçš„ç»Ÿè®¡æ£€éªŒï¼šK-Sæ£€éªŒ}
Kolmogorov-Smirnovæ£€éªŒï¼ˆK-Sæ£€éªŒï¼‰ï¼Œå¯ç”¨äºæ£€éªŒä¸€ä¸ªåˆ†å¸ƒä¸ç†æƒ³åˆ†å¸ƒæ˜¯å¦ç›¸åŒã€‚
\begin{itemize}
    \item $H_0$: æ ·æœ¬æ•°æ®çš„åˆ†å¸ƒä¸ç†æƒ³åˆ†å¸ƒæ— æ˜¾è‘—å·®å¼‚
    \item $p$-value: åŸå‡è®¾ä¸ºçœŸæ—¶æ ·æœ¬è§‚å¯Ÿç»“æœå‡ºç°çš„æ¦‚ç‡
\begin{itemize}
    \item $p$-value$>5\%$ï¼Œ$H_0$æˆç«‹ï¼›
    \item $p$-value$<5\%$ï¼Œ$H_0$ä¸æˆç«‹
\end{itemize}
\end{itemize}

\begin{lstlisting}
    from scipy.stats import kstest
    kstest(rvs, cdf, args)
\end{lstlisting}



\end{frame}

\begin{frame}[fragile]{K-Sæ£€éªŒ(cont.)}
\begin{lstlisting}
    kstest(rvs, cdf, args)
\end{lstlisting}
\begin{itemize}
    \item \verb|rvs| æŒ‡å®šè¦ç»Ÿè®¡çš„æ•°æ®ï¼ˆéšæœºå˜é‡æ ·æœ¬ï¼‰ã€‚
    \item \verb|cdf| æŒ‡å®šåˆ©ç”¨å“ªä¸ªæ¦‚ç‡åˆ†å¸ƒå¯¹æ•°æ®/å˜é‡è¿›è¡Œåˆ†å¸ƒæ‹Ÿåˆä¼˜åº¦æ£€éªŒã€‚
    \begin{itemize}
        \item å½“\verb|cdf='norm'|æ—¶ï¼Œè¦æ£€éªŒçš„æ˜¯æ­£æ€åˆ†å¸ƒï¼›
        \item å½“\verb|cdf='chi2'|æ—¶ï¼Œæ£€éªŒå¡æ–¹$\chi^2$åˆ†å¸ƒï¼›
        \item å½“\verb|cdf='t'|æ—¶ï¼Œæ£€éªŒ$t$åˆ†å¸ƒï¼›
        \item å½“\verb|cdf='f'|æ—¶ï¼Œæ£€éªŒ$F$åˆ†å¸ƒ
    \end{itemize}
    
    \item \verb|args| è¾“å…¥å½“\verb|rvs|æˆ–\verb|cdf|æ˜¯å­—ç¬¦ä¸²æˆ–å¼•ç”¨å¯¹è±¡æ—¶ä½¿ç”¨ï¼Œè¾“å…¥å½¢å¼ä¸ºå…ƒç»„ã€åºåˆ—ã€‚    
    å½“
    \verb|cdf='norm'|æ—¶ï¼Œ\verb|args=(rvs.mean(),rvs.std())|, å³å¾…æ£€éªŒæ•°æ®çš„å‡å€¼å’Œæ–¹å·®
    \item è¯¥å‡½æ•°ä¼šè¿”å›ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯K-Sæ£€éªŒç»Ÿè®¡é‡ï¼Œå¦ä¸€ä¸ªæ˜¯$p$-valueå€¼
\end{itemize}
\end{frame}


\begin{frame}[fragile]{æ­£æ€åˆ†å¸ƒçš„K-Sæ£€éªŒ}
æ²ªæ·±300æŒ‡æ•°çš„æ—¥æ”¶ç›Šç‡æ•°æ®ï¼ˆ\verb|csi300_returns|ï¼‰è¿›è¡ŒK-Sæ£€éªŒ
\begin{lstlisting}
from scipy.stats import kstest 
ks_results = kstest(csi300_returns['æ”¶ç›Šç‡'], 'norm', 
             (csi300_returns.mean(), csi300_returns.std()))
print(ks_results)
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]{è¡¥å……ï¼šæ£€éªŒæ­£æ€åˆ†å¸ƒçš„Jarque-Beraæ£€éªŒ}
æ²ªæ·±300æŒ‡æ•°çš„æ—¥æ”¶ç›Šç‡æ•°æ®ï¼ˆ\verb|csi300_returns|ï¼‰è¿›è¡ŒJarque-Beraæ£€éªŒ
\begin{lstlisting}
from scipy.stats import jarque_bera
jb_results = jarque_bera(csi300_returns['æ”¶ç›Šç‡'])
print(jb_results)
\end{lstlisting}
\end{frame}



\begin{frame}[fragile]{$t$åˆ†å¸ƒ}
\[t=\frac{X}{\sqrt{Y/n}}\sim t(n)\]
å…¶ä¸­ï¼š$X\sim \mathcal{N}(0,1),\qquad Y\sim \chi^2(n)$

$t$åˆ†å¸ƒä¸æ­£æ€åˆ†å¸ƒä¸»è¦åŒºåˆ«åœ¨äºï¼Œ$t$åˆ†å¸ƒç”¨å°æ ·æœ¬æ¥ä¼°è®¡å‘ˆæ­£æ€åˆ†å¸ƒä¸”æ–¹å·®æœªçŸ¥çš„åˆ†å¸ƒ
\end{frame}


\begin{frame}[fragile]{$t$åˆ†å¸ƒçš„æ£€éªŒæ­¥éª¤}
\begin{enumerate}
    \item å¯¹æ ·æœ¬æ•°æ®è¿›è¡Œ$t$åˆ†å¸ƒæ‹Ÿåˆ
    \begin{lstlisting}
        stats.t.fit(æ ·æœ¬æ•°æ®)
    \end{lstlisting}
    \item åŸºäºåˆ†å¸ƒæ‹Ÿåˆçš„ç»“æœï¼Œè¿›è¡ŒK-Sæ£€éªŒ
    \begin{lstlisting}
        kstest(rvs, 't', (df, loc, scale))
    \end{lstlisting}
\end{enumerate}
\end{frame}


\begin{frame}[fragile]{$t$åˆ†å¸ƒçš„æ£€éªŒ}
\begin{lstlisting}
from scipy import stats
#å¯¹æ”¶ç›Šç‡è¿›è¡Œtåˆ†å¸ƒæ‹Ÿåˆ
args = stats.t.fit(csi300_returns['æ”¶ç›Šç‡']) 
# æ‹Ÿåˆåè·å–çš„argså€¼åˆ†åˆ«ä¸ºè‡ªç”±åº¦ï¼ˆdfï¼‰ã€
# ä½ç½®å‚æ•°ï¼ˆlocï¼‰ã€å°ºåº¦å‚æ•°(scale)
print(args) 
# å¯¹æ”¶ç›Šç‡æ•°æ®è¿›è¡Œtåˆ†å¸ƒçš„KSç»Ÿè®¡æ£€éªŒ
ks_results = kstest(csi300_returns['æ”¶ç›Šç‡'], 't', 
                        (args[0], args[1], args[2]))
print(ks_results)
\end{lstlisting}
\end{frame}

\subsection{æ”¶ç›Šç‡å‡å€¼çš„åŒºé—´ä¼°è®¡}
\begin{frame}[fragile]{åŒºé—´ä¼°è®¡}
ç¡®ä¿ä¸€å®šæ¦‚ç‡ä¸‹æ€»ä½“å‡å€¼çš„çœŸå®å€¼æ‰€åœ¨çš„åŒºé—´èŒƒå›´ç§°
ä¸ºç½®ä¿¡åŒºé—´ï¼ˆconfidence intervalï¼‰ï¼Œè€Œä¼°è®¡ç½®ä¿¡åŒºé—´çš„æ–¹æ³•ç§°ä¸ºåŒºé—´ä¼°è®¡
\begin{enumerate}
    \item æ ‡å‡†å·®å·²çŸ¥æƒ…å½¢
    \item æ ‡å‡†å·®æœªçŸ¥æƒ…å½¢ï¼ˆä½¿ç”¨æ ·æœ¬æ ‡å‡†å·®æ›¿ä»£ï¼‰
\end{enumerate}
\end{frame}


\begin{frame}[fragile]{æ ‡å‡†å·®å·²çŸ¥æƒ…å½¢}
    è®¾æ ·æœ¬æ•°æ®$X$çš„æ€»ä½“æœŸæœ›ä¸º$\mu$ï¼Œæ–¹å·®ä¸º$\sigma^2$
\[Z=\frac{\bar x-\mu}{\sigma/\sqrt{n}}\sim \mathcal{N}(0,1)\]

å‡è®¾$\alpha$ä¸ºç½®ä¿¡åº¦ï¼Œå½“æ€»ä½“æ ‡å‡†å·®å·²çŸ¥æ—¶ï¼Œæ€»ä½“å‡å€¼è¿‘ä¼¼($1-\alpha$)çš„å¯ä¿¡åº¦ï¼Œåˆ†å¸ƒåœ¨ä»¥ä¸‹ç½®ä¿¡åŒºé—´å†…ï¼š
\[\left[\bar x-z_{\alpha/2}\frac{\sigma}{\sqrt{n}},\; \bar x+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right]\]


\begin{center}
\begin{tikzpicture}[scale=2.2]
\draw[fill, color=gray!50!white, domain=-1:1, samples=100, thick]plot(\x, {exp(-\x*\x)})--(1,0)--(-1,0)--(-1,.368);
\draw[fill, color=pink!50!white, domain=-2.5:-1, samples=100, thick]plot(\x, {exp(-\x*\x)})--(-1,.368)--(-1,0);
\draw[fill, color=pink!50!white, domain=1:2.5, samples=100, thick]plot(\x, {exp(-\x*\x)})--(1,0)--(1,.368);

\node[fill=white] at (0,.35){$1-\alpha$}; 
\draw(-2.5,0)--(2.5,0);
\draw[domain=-2.5:2.5, samples=100, very thick, blue]plot(\x, {exp(-\x*\x)});
\draw[<-](-1.25,.1)--(-1.65,.4)node[left]{$\alpha/2$};
\draw[<-](1.25,.1)--(1.65,.4)node[right]{$\alpha/2$};
\draw[dashed](-1,0)node[below]{$-z_{\alpha/2}$}--(-1,.6);
\draw[dashed](1,0)node[below]{$z_{\alpha/2}$}--(1,.6);

\end{tikzpicture}
\end{center}
\end{frame}


\begin{frame}[fragile]{$z_{q}$çš„è®¡ç®—}
\begin{center}
\begin{tikzpicture}[scale=1.2]
\draw[fill, color=pink!50!white, domain=1:2.5, samples=100, thick]plot(\x, {exp(-\x*\x)})--(1,0)--(1,.368);
\draw[fill, color=gray!50!white, domain=-2.5:1, samples=100, thick]plot(\x, {exp(-\x*\x)})--(1,0)--(-2.5,0);

\node[fill=white] at (0,.35){$1-q$}; 
\draw(-2.5,0)--(2.5,0);
\draw[domain=-2.5:2.5, samples=100, very thick, blue]plot(\x, {exp(-\x*\x)});
\draw[<-](1.25,.1)--(1.65,.4)node[right]{$q$};

\draw[dashed](1,0)node[below]{$z_{q}$}--(1,.6);
\end{tikzpicture}
\end{center}

Pythonçš„\verb|scipy|åº“ä¸­\verb|norm.isf|å‡½æ•°å¯ä»¥ç”¨äºè®¡ç®—$z_q$å€¼ã€‚\verb|isf|æ˜¯Inverse Survival Functionï¼ˆåç”Ÿå­˜å‡½æ•°ï¼‰çš„ç¼©å†™ã€‚
\begin{lstlisting}
    from scipy import stats
    stats.norm.isf(q, loc, scale)
\end{lstlisting}
\begin{itemize}
    \item \verb|q| æ­£æ€åˆ†å¸ƒä¸Šä¾§é¢ç§¯ï¼ˆæ¦‚ç‡ï¼‰
    \item \verb|loc| å¯é€‰é¡¹ï¼Œä½ç½®å‚æ•°ï¼ˆ$\mu$ï¼‰ï¼Œé»˜è®¤å–å€¼ä¸º0
    \item \verb|scale| å¯é€‰é¡¹ï¼Œå°ºåº¦å‚æ•°ï¼ˆ$\sigma$ï¼‰ï¼Œé»˜è®¤å–å€¼ä¸º1
\end{itemize}
\end{frame}


\begin{frame}[fragile]{æ ‡å‡†å·®æœªçŸ¥}
åœ¨å®è·µä¸­ï¼Œå¾€å¾€æ˜¯ä¸çŸ¥é“æ ·æœ¬æ ‡å‡†å·®çš„ã€‚å¦‚æœ æ ·æœ¬é‡è¾ƒå°æˆ–æ€»ä½“æ ‡å‡†å·®$\sigma$æœªçŸ¥ï¼Œæ­¤æ—¶å¯ä»¥åˆ©ç”¨æ ·æœ¬æ ‡å‡†å·®$s$æ¥ä¼°è®¡$\sigma$ã€‚
æ€»ä½“å‡å€¼çš„åŒºé—´ä»¥è‡ªç”±åº¦ä¸º$(n-1)$çš„$t$åˆ†å¸ƒä¸ºä¾æ®è¿›è¡Œä¼°è®¡
\[t=\frac{\bar x-\mu}{s/\sqrt{n}}\sim t(n-1)\]

å‡è®¾$\alpha$ä¸ºç½®ä¿¡åº¦ï¼Œæ€»ä½“å‡å€¼è¿‘ä¼¼($1-\alpha$)çš„å¯ä¿¡åº¦ï¼Œåˆ†å¸ƒåœ¨ä»¥ä¸‹ç½®ä¿¡åŒºé—´å†…ï¼š
\[\left[\bar x-t_{\alpha/2}(n-1)\frac{s}{\sqrt{n}},\; \bar x+t_{\alpha/2}(n-1)\frac{s}{\sqrt{n}}\right]\]
\end{frame}


\begin{frame}[fragile]{$t_q(n)$çš„è®¡ç®—}
Pythonçš„\verb|scipy|åº“ä¸­\verb|t.isf|å‡½æ•°å¯ä»¥ç”¨äºè®¡ç®—$t_q(n)$å€¼
\begin{lstlisting}
    from scipy import stats
    stats.norm.isf(q, n, loc, scale)
\end{lstlisting}
\begin{itemize}
    \item \verb|q| $t$åˆ†å¸ƒä¸Šä¾§é¢ç§¯ï¼ˆæ¦‚ç‡ï¼‰
    \item \verb|n| è‡ªç”±åº¦
    \item \verb|loc| å¯é€‰é¡¹ï¼Œä½ç½®å‚æ•°ï¼ˆ$\mu$ï¼‰ï¼Œé»˜è®¤å–å€¼ä¸º0
    \item \verb|scale| å¯é€‰é¡¹ï¼Œå°ºåº¦å‚æ•°ï¼ˆ$\sigma$ï¼‰ï¼Œé»˜è®¤å–å€¼ä¸º1
\end{itemize}
\end{frame}

\section{é‡‘èæ•°æ®æ—¶é—´åºåˆ—åˆ†æ}
\subsection{æ—¶é—´åºåˆ—çš„å«ä¹‰}
\begin{frame}[fragile]{æ—¶é—´åºåˆ—çš„å«ä¹‰}
æœ€æ—©çš„æ—¶é—´åºåˆ—åˆ†æå¯ä»¥è¿½
æº¯åˆ°7000å¹´å‰çš„å¤åŸƒåŠï¼Œ
é€šè¿‡å¯¹å°¼ç½—æ²³æ¶¨è½çš„æƒ…å†µè¿™
ä¸ªæ—¶é—´åºåˆ—çš„é•¿æœŸè§‚å¯Ÿï¼ŒæŒ
æ¡äº†å°¼ç½—æ²³æ³›æ»¥çš„è§„å¾‹ï¼Œå¤
åŸƒåŠçš„å†œä¸šè¿…é€Ÿå‘å±•ï¼Œä»è€Œ
åˆ›å»ºäº†å¤åŸƒåŠç¿çƒ‚çš„å²å‰æ–‡
æ˜

å°†å°¼ç½—æ²³æ¶¨è½çš„æƒ…å†µæŒ‰
ç…§æ—¶é—´çš„é¡ºåºæŠŠéšæœºäº‹
ä»¶çš„è¿‡ç¨‹è®°å½•ä¸‹æ¥å°±æ„
æˆäº†ä¸€ä¸ªæ—¶é—´åºåˆ—

ä»ç§‘å­¦çš„è§’åº¦è®²ï¼ŒæŒ‰æ—¶
é—´é¡ºåºæ’åˆ—çš„ä¸€ç»„éšæœº
å˜é‡$X = \{x_1 , x_2,\ldots x_t\}$
ç§°ä¸ºæ—¶é—´åºåˆ—(time series)ï¼Œå…¶ä¸­çš„
$ğ‘¥_n$ç§°ä¸ºæ—¶é—´åºåˆ—çš„è§‚æµ‹
å€¼
\end{frame}


\begin{frame}[fragile]{æ—¶é—´åºåˆ—çš„ç ”ç©¶æ–¹æ³•}
å¹³ç¨³æ—¶é—´åºåˆ—ï¼šæ—¶é—´åºåˆ—ä¸å­˜åœ¨è¶‹åŠ¿å˜åŒ–ï¼Œå…¶è§‚å¯Ÿå€¼å›´ç»•å‡å€¼åœ¨æŸä¸ªå›ºå®šçš„æ°´å¹³å†…ä¸Šä¸‹æ³¢åŠ¨
\begin{itemize}
    \item æ—¶é—´åºåˆ—çš„å‡å€¼ä¸æ—¶é—´å˜é‡æ— å…³
    \item æ—¶é—´åºåˆ—çš„æ–¹å·®ä¸æ—¶é—´å˜é‡æ— å…³
    \item   æ—¶é—´åºåˆ—çš„åæ–¹å·®åªä¸æ—¶æœŸé—´éš”æœ‰å…³ï¼Œä¸æ—¶é—´å˜é‡æ— å…³
\end{itemize}

\begin{block}{å¹³ç¨³æ—¶é—´åºåˆ—åˆ†ç±»}
   \begin{itemize}
    \item çº¯éšæœºåºåˆ—ï¼šå˜åŒ–æ²¡æœ‰ä»»ä½•è§„å¾‹å¯å¾ªï¼Œä¸åŒæ—¶é—´ç‚¹çš„è§‚æµ‹
    å€¼äº’ä¸ç›¸å…³ï¼Œä¸èƒ½ä»
    ä¸­æ‰¾å‡ºè§„å¾‹è¿›è¡Œæ¨¡æ‹Ÿ
    æ‹Ÿåˆï¼Œä¹Ÿæ— æ³•ç”±å†å²
    å€¼æ¨æµ‹æœªæ¥å€¼
    \item éçº¯éšæœºåºåˆ—ï¼šå¹³ç¨³çš„éçº¯éšæœºæ—¶é—´
    åºåˆ—ï¼Œåˆ™æœ‰å¾ˆå¤šæ¨¡å‹
    å¯ä»¥ç”¨æ¥æ‹Ÿåˆï¼Œå…¶ä¸­
    æœ€å¸¸ç”¨ARMAæ¨¡å‹
\end{itemize} 
\end{block}

\end{frame}

\subsection{æ—¶é—´åºåˆ—çš„æ£€éªŒ}
\begin{frame}[fragile]{å¹³ç¨³æ€§æ£€éªŒ}
\begin{itemize}
    \item å›¾æ£€éªŒæ³•ï¼šæ—¶åºå›¾ã€è‡ªç›¸å…³å›¾ï¼ˆåŸºæœ¬åˆ¤æ–­ï¼‰
    \item ç»Ÿè®¡æ£€éªŒæ³•ï¼šæ„é€ æ£€éªŒç»Ÿè®¡é‡ï¼ˆè¾…åŠ©åˆ¤æ–­ï¼‰
\end{itemize}

\end{frame}


\begin{frame}[fragile]{æ—¶åºå›¾æ£€éªŒ}
    æ—¶é—´åºåˆ—æ˜¯å¹³ç¨³åºåˆ—ï¼Œåˆ™æ—¶åºå›¾
    ä¸­çš„è§‚æµ‹å€¼åº”å›´ç»•å…¶å‡å€¼ï¼Œåœ¨ä¸€
    å®šèŒƒå›´å†…ä¸Šä¸‹æ³¢åŠ¨ã€‚åä¹‹ï¼Œå¦‚æœ
    æ—¶åºå›¾æœ‰æ˜æ˜¾çš„è¶‹åŠ¿æ€§æˆ–å‘¨æœŸæ€§ï¼Œ
    åˆ™è¯¥æ—¶é—´åºåˆ—å¾ˆå¯èƒ½ä¸æ˜¯å¹³
    ç¨³åºåˆ—

æ—¶åºå›¾ï¼šä»¥æ—¶é—´ä¸ºæ¨ªè½´ã€ä»¥è§‚æµ‹å€¼ä¸ºçºµè½´çš„æ—¶é—´åºåˆ—æŠ˜çº¿å›¾


\end{frame}


\begin{frame}[fragile]{æ—¶åºå›¾ç»˜åˆ¶}
\begin{lstlisting}
    df.plot(x=None, y=None, kind='line')
\end{lstlisting}
\begin{itemize}
    \item \verb|x|, \verb|y| ç”¨æ¥æŒ‡å®šç»˜å›¾çš„æ•°æ®ï¼Œå¯¹åº”\verb|df|ä¸­çš„{\color{red}åˆ—ç´¢å¼•}
    \item \verb|kind| è®¾ç½®ç»˜å›¾çš„ç±»å‹ï¼Œé»˜è®¤ä¸ºæŠ˜çº¿å›¾
\end{itemize}

\end{frame}

\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šå¹³å®‰é“¶è¡Œçš„æ•°æ®}
\begin{lstlisting}
import pandas as pd
import matplotlib.pyplot as plt
data = pd.read_excel('å¹³å®‰é“¶è¡Œ.xlsx', index_col=0) 
data['æ”¶ç›˜ä»·'].plot() # ç»˜åˆ¶è‚¡ç¥¨æ”¶ç›˜ä»·çš„æ—¶é—´åºåˆ—å›¾
plt.xlabel('æ—¶é—´')
plt.ylabel('æ”¶ç›˜ä»·')  # è®¾ç½®xè½´ã€yè½´çš„æ ‡ç­¾æ–‡æœ¬
plt.show()               # å›¾ç‰‡æ˜¾ç¤º
data['æ”¶ç›Šç‡'].plot()  # ç»˜åˆ¶è‚¡ç¥¨æ”¶ç›Šç‡çš„æ—¶é—´åºåˆ—å›¾
plt.xlabel('æ—¶é—´') 
plt.ylabel('æ”¶ç›Šç‡')  # è®¾ç½®xè½´ã€yè½´çš„æ ‡ç­¾æ–‡æœ¬
plt.show()               # å›¾ç‰‡æ˜¾ç¤º
\end{lstlisting}


\end{frame}


\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šå¹³å®‰é“¶è¡Œçš„æ•°æ®(cont.)}
ä»¥ä¸¤ä¸ªå­å›¾å±•ç¤ºç›¸å…³å›¾ç‰‡
\begin{lstlisting}
import pandas as pd;   import matplotlib.pyplot as plt
data = pd.read_excel('å¹³å®‰é“¶è¡Œ.xlsx', index_col=0) 
fig, axes = plt.subplots(nrows=1, ncols=2, figsize(14,6))
axes[0].plot(data['æ”¶ç›˜ä»·'])
axes[0].set_xlabel('æ—¶é—´'); axes[0].set_ylabel('æ”¶ç›˜ä»·')  
axes[1].plot(data['æ”¶ç›Šç‡'])  
axes[1].set_xlabel('æ—¶é—´'); axes[1].set_ylabel('æ”¶ç›Šç‡') 
plt.show()
\end{lstlisting}


\end{frame}

\begin{frame}[fragile]{è‡ªç›¸å…³æ£€éªŒâ€”â€”è‡ªç›¸å…³å‡½æ•°}
å¯¹äºæ—¶é—´åºåˆ—$X_t$ï¼Œå–æ ·æœ¬$X_n=\{x_1,x_2,\ldots, x_n\}$ï¼Œå°†$X_n$æ»å$k$é˜¶åå½¢æˆçš„æ ·æœ¬è®°ä¸º$X_{n+k}$ï¼Œå³ï¼š
\[X_{n+k}=\{x_{1+k},x_{2+k},\ldots, x_{n+k}\}\]
ä¸¤è€…ä¹‹é—´çš„åæ–¹å·®å‡½æ•°å¦‚ä¸‹ï¼š
\[{\rm Cov}(X_n,X_{n+k})=\E\Big\{\big[X_n-\E(X_n)\big]\big[X_{n+k}-\E(X_{n+k})\big]\Big\}\]
ä¸¤è€…ä¹‹é—´çš„è‡ªç›¸å…³å‡½æ•°ï¼ˆAutoCorrelation Function, ACFï¼‰å¦‚ä¸‹ï¼š
\[\rho_k=\frac{{\rm Cov}(X_n,X_{n+k})}{\sigma_n \sigma_{n+k}},\qquad k=1,2,\ldots \]


\end{frame}

\begin{frame}[fragile]{è‡ªç›¸å…³å‡½æ•°(cont.)}
    è‡ªç›¸å…³å‡½æ•°å¯ä»¥åº¦é‡åŒä¸€äº‹ä»¶åœ¨ä¸¤ä¸ªä¸åŒæ—¶æœŸçš„ç›¸å…³ç¨‹åº¦ã€‚å–å€¼è¶Šå¤§ï¼Œæ„å‘³ç€æ—¶é—´åºåˆ—è‡ªèº«çš„è®°å¿†æ€§è¶Šå¼ºï¼Œå†å²å¯¹å½“å‰çš„å½±å“è¶Šå¤§

    è‹¥æ—¶é—´åºåˆ—æ˜¯å¹³ç¨³çš„ï¼Œåˆ™è‡ªç›¸å…³å‡½æ•°åªä¸é—´éš”æ—¶é—´$k$æœ‰å…³ï¼Œè€Œä¸æ—¶é—´å˜é‡$n$æ— å…³ï¼Œå¹¶ä¸”å½“$k$è¾ƒå¤§æ—¶ï¼Œ$X_n$ä¸$X_{n+k}$åº”å½“ç›¸äº’ç‹¬ç«‹ï¼Œè‡ªç›¸å…³ç³»æ•°ä¸º0

å¯¹äºå¹³ç¨³æ—¶é—´åºåˆ—è€Œè¨€ï¼Œå…¶è‡ªç›¸å…³ç³»æ•°ä¸€èˆ¬ä¼šå¿«é€Ÿå‡å°è‡³0é™„è¿‘ï¼Œæˆ–è€…åœ¨æŸä¸€é˜¶åå˜ä¸º0ï¼ˆæˆªå°¾ï¼‰ï¼›éå¹³ç¨³æ—¶é—´åºåˆ—çš„è‡ªç›¸å…³ç³»æ•°ä¸€èˆ¬æ˜¯ç¼“æ…¢ä¸‹é™ï¼ˆæ‹–å°¾ï¼‰ã€‚
\end{frame}


\begin{frame}[fragile]{è‡ªç›¸å…³å›¾çš„ç»˜åˆ¶}
\begin{lstlisting}
from statsmodels.graphics.tsaplots import plot_acf
plot_acf(x, ax=None, lags=None, alpha=0.05, 
            title='Autocorrelation')
\end{lstlisting}
\begin{itemize}
    \item \verb|x| å¾…æ£€æµ‹çš„æ—¶é—´åºåˆ—ï¼›
    \item \verb|ax| ç»˜åˆ¶å­å›¾çš„é€‰é¡¹ï¼Œé»˜è®¤ä¸ç»˜åˆ¶å­å›¾ï¼›
    \item \verb|lags| å¯é€‰é¡¹ï¼Œè¡¨ç¤ºæ»åé˜¶æ•°çš„æœ€å¤§å€¼ï¼Œè¾“å…¥ä¸ºæ•´æ•°å€¼ï¼›
    \item \verb|alpha| å¯é€‰é¡¹ï¼Œé»˜è®¤è¿”å›95\%çš„ç½®ä¿¡åŒºé—´ï¼›
    \item \verb|title| æ˜¾ç¤ºè‡ªç›¸å…³å›¾çš„æ ‡é¢˜
\end{itemize}
\end{frame}

\begin{frame}[fragile]{åè‡ªç›¸å…³å›¾çš„ç»˜åˆ¶}
åºåˆ—çš„åè‡ªç›¸å…³å›¾ï¼ˆPartial AutoCorrelation Function, PACFï¼‰ï¼Œä½¿ç”¨å‡½æ•°\verb|plot_pacf|ç»˜åˆ¶ã€‚ç”¨æ³•ä¸è‡ªç›¸å…³å›¾å‡½æ•°\verb|plot_acf|ç›¸åŒã€‚åè‡ª
ç›¸å…³å›¾å¯ç”¨äºæ—¶é—´åºåˆ—ARMAæ¨¡å‹å®šé˜¶
\begin{lstlisting}
from statsmodels.graphics.tsaplots import plot_pacf
plot_pacf(x, ax=None, lags=None, alpha=0.05, 
            title='Partial Autocorrelation')
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šå¹³å®‰é“¶è¡Œæ”¶ç›˜ä»·å’Œæ”¶ç›Šç‡çš„è‡ªç›¸å…³ä¸åè‡ªç›¸å…³å›¾}
\normalsize
\begin{lstlisting}
from statsmodels.graphics.tsaplots import plot_acf, plot_pacf 
import matplotlib.pyplot as plt
fig, axes = plt.subplots(nrows=2, ncols=2, figsize=(10,10))
plot_acf(x, ax=axes[0,0], lags=30, title='ACF of close price') 
plot_pacf(x, ax=axes[0,1], lags=30, title='PACF of close price') 
plot_acf(y, ax=axes[1,0], lags=30, title='ACF of return') 
plot_pacf(y, ax=axes[1,1], lags=30, title='PACF of return') 
\end{lstlisting} 

ç»˜åˆ¶å‡ºçš„å›¾ï¼Œä»¥$2\times 2$çš„å­å›¾æ’åˆ—ï¼Œæ­¤å¤„\verb|x|å’Œ\verb|y|åˆ†åˆ«å¯¹åº”å¹³å®‰é“¶è¡Œæ”¶ç›˜ä»·å’Œæ”¶ç›Šç‡åºåˆ—
\end{frame}

\subsection{å•ä½æ ¹æ£€éªŒ}
\begin{frame}[fragile]{å•ä½æ ¹çš„æ¦‚å¿µ}
å¯¹äºä¸‹åˆ—æ–¹ç¨‹ï¼š
\[x_t=bx_{t-1}+a+\varepsilon\]
è‹¥$b=1$ï¼Œåˆ™ç§°ä¸ºå•ä½æ ¹ã€‚å•ä½æ ¹çš„å­˜åœ¨ï¼Œæ„å‘³ç€å¯¹åº”çš„åºåˆ—$\{x_t\}$ä¸å¹³ç¨³ï¼Œæ— æ³•å¯¹å…¶è¿›è¡Œé¢„æµ‹

å•ä½æ ¹æ£€éªŒæ³•å°±æ˜¯åˆ¤æ–­æ—¶é—´åºåˆ—å¹³ç¨³æ€§çš„æ–¹æ³•ä¹‹ä¸€ï¼Œé€šå¸¸ç§°ä½œADFæ£€éªŒï¼ˆAugmented Dickey-Fuller testï¼‰
\end{frame}


\begin{frame}[fragile]{ADFæ£€éªŒ}
åŸå‡è®¾$H_0$æ˜¯å•ä½æ ¹å­˜åœ¨ï¼Œ
åºåˆ—ä¸å¹³ç¨³ï¼›å¤‡æ‹©å‡è®¾$H_1$æ˜¯å•ä½æ ¹ä¸å­˜
åœ¨ï¼Œåºåˆ—å¹³ç¨³
\begin{itemize}
    \item ADFçš„$T$-ç»Ÿè®¡é‡çš„ç»å¯¹å€¼å¤§äº1\%ï¼Œ5\%ï¼Œ10\% ä¸åŒç½®ä¿¡åº¦æ°´å¹³ä¸‹$T$-ç»Ÿè®¡é‡çš„ç» å¯¹å€¼ï¼Œåˆ™æ‹’ç»åŸå‡è®¾
    \item ADFçš„\verb|p-value|æ˜¯æŒ‡åŸå‡è®¾ä¸ºçœŸçš„æ¦‚ç‡ï¼Œå¦‚æœ\verb|p-value|å€¼éå¸¸æ¥è¿‘0ï¼Œåˆ™æ‹’ç»åŸå‡è®¾
\end{itemize}
\end{frame}


\begin{frame}[fragile]{å¹³ç¨³æ€§æ£€éªŒ}
pythonçš„\verb|statsmodels|åº“ä¸­ï¼Œ\verb|adfuller|å‡½æ•°å¯ä»¥ç”¨äºå•ä½æ ¹æ£€éªŒ
\begin{lstlisting}
adfuller(x, regression='c', maxlag=None, store=False, regresults=False)
\end{lstlisting}
\begin{itemize}
    \item \verb|x| å¾…æ£€éªŒçš„æ—¶é—´åºåˆ—; 
    \item \verb|regression| å›å½’æ–¹ç¨‹ä¸­çš„å‚æ•°è®¾å®šï¼Œé»˜è®¤åªåŒ…å«å¸¸æ•°é¡¹ï¼Œå¯é€‰å‚æ•°æœ‰ï¼š\verb|ct|å¸¸æ•°é¡¹å’Œè¶‹åŠ¿é¡¹ï¼›\verb|ctt|å¸¸æ•°é¡¹ï¼Œçº¿æ€§äºŒæ¬¡é¡¹ï¼›\verb|nc|æ²¡æœ‰å¸¸æ•°é¡¹å’Œè¶‹åŠ¿é¡¹
    \item \verb|maxlag| æœ€å¤§å»¶è¿ŸæœŸæ•°ï¼Œéœ€è¾“å…¥æ•´æ•°å€¼; 
    \item \verb|store| é»˜è®¤ä¸è¿”å›adfç»Ÿè®¡ä¿¡æ¯çš„ç»“æœ; 
    \item \verb|regresults|  é»˜è®¤è¿”å›å®Œæ•´çš„å›å½’ç»“æœ
\end{itemize}
\end{frame}


\begin{frame}[fragile]{å¹³ç¨³æ€§æ£€éªŒä¸¾ä¾‹}
\begin{lstlisting}
from statsmodels.tsa.stattools import adfuller
dftest1 = adfuller(data['æ”¶ç›˜ä»·']); print(dftest1)
dftest2 = adfuller(data['æ”¶ç›Šç‡']); print(dftest2)
\end{lstlisting}

\begin{block}{ç»“æœè§£è¯»}
è¾“å‡ºç»“æœä»¥å…ƒç»„å½¢å¼å±•ç°ï¼šç¬¬ä¸€ä¸ªå€¼è¡¨ç¤º$T$ç»Ÿè®¡é‡ï¼›
ç¬¬äºŒä¸ªå€¼æ˜¯ \verb|p-value|ï¼Œå³$p$å€¼ï¼Œè¡¨ç¤º$T$ç»Ÿè®¡é‡å¯¹åº”çš„æ¦‚ç‡ï¼›ç¬¬ä¸‰ä¸ªå€¼æ˜¯æ»åé˜¶æ•°ï¼›ç¬¬å››ä¸ªå€¼æ˜¯è§‚æµ‹å€¼æ•°é‡ï¼›ç¬¬äº”ä¸ªæ˜¯å­—å…¸ï¼Œå­˜å‚¨çš„æ˜¯1\%ã€5\%ã€10\%ä¸‰ä¸ªæ°´å¹³ä¸‹çš„$T$ç»Ÿè®¡é‡å–å€¼
\end{block}
\end{frame}

\subsection{çº¯éšæœºæ€§æ£€éªŒ}
\begin{frame}[fragile]{çº¯éšæœºåºåˆ—}
    çº¯éšæœºåºåˆ—ä¹Ÿç§°ä¸ºç™½å™ªå£°ï¼ˆwhite noiseï¼‰ï¼Œåºåˆ—ä¸­ä»»æ„ä¸¤ä¸ªä¸åŒæ—¶é—´çš„æ•°æ®ç›¸äº’ç‹¬ç«‹ã€äº’ä¸ç›¸å…³ï¼Œæ•°æ®é—´æ²¡æœ‰è§„å¾‹å¯å¾ªï¼Œ
    ä¸å…·æœ‰å»ºæ¨¡åˆ†æçš„ä»·å€¼

    çº¯éšæœºæ€§æ£€éªŒçš„ç›®çš„å°±æ˜¯å‰”é™¤æ‰çº¯éšæœºåºåˆ—ï¼Œæ£€æµ‹é‚£äº›åºåˆ—å€¼ä¹‹é—´å…·æœ‰å¯†åˆ‡ç›¸å…³å…³ç³»ï¼Œå†å²æ•°æ®å¯¹æœªæ¥çš„å‘å±•å…·æœ‰ä¸€å®šå½±å“çš„éçº¯éšæœºåºåˆ—
\end{frame}


\begin{frame}[fragile]{çº¯éšæœºæ€§æ£€éªŒ}
\begin{block}{Barlettå®šç†}
å¦‚æœä¸€ä¸ªæ—¶é—´åºåˆ—æ˜¯çº¯éšæœºçš„ï¼Œå¾—åˆ°ä¸€ä¸ªè§‚å¯ŸæœŸæ•°ä¸º$n$çš„åºåˆ—$x_t$ï¼Œ é‚£ä¹ˆè¯¥åºåˆ—çš„æ»å$k\; (k=\ne 0)$æœŸçš„æ ·æœ¬è‡ªç›¸å…³ç³»æ•°$\hat\rho_k$å°†è¿‘ä¼¼æœä»å‡å€¼ä¸ºé›¶ã€ æ–¹å·®ä¸º$1/n$çš„æ­£æ€åˆ†å¸ƒ
\[\hat\rho_k \sim \mathcal{N}\left(0,\frac{1}{n}\right),\qquad \forall k\ne 0 \]
\end{block}

æ ¹æ®Barlettå®šç†ï¼Œå¯ä»¥é€šè¿‡æ„é€ $Q$ç»Ÿè®¡é‡å’Œ$LB$ï¼ˆLjung-Boxï¼‰ç»Ÿè®¡é‡æ¥æ£€éªŒåºåˆ—çš„çº¯éšæœºæ€§
\end{frame}


\begin{frame}[fragile]{çº¯éšæœºæ€§æ£€éªŒâ€”â€”$Q$ç»Ÿè®¡é‡}
Box å’ŒPierceæ¨å¯¼å‡º$Q$ç»Ÿè®¡é‡
\[Q=n\sum^m_{k=1}\hat \rho^2_k \mathop{\sim}^{\rm asy.}  \chi^2(m)\]
å…¶ä¸­ï¼š$n$ä¸ºåºåˆ—è§‚æµ‹æœŸæ•°ï¼›$m$ä¸ºè®¾å®šçš„æ»åé˜¶æ•°

\begin{block}{è¯´æ˜ï¼š}
    $Q$ç»Ÿè®¡é‡é€‚ç”¨äº$n$å–å€¼å¾ˆå¤§ï¼ˆå¤§æ ·æœ¬ï¼‰çš„åœºåˆï¼Œæ­¤å¤„åªæ˜¯æ¸è¿‘åœ°ï¼ˆasymptoticï¼‰æœä»è‡ªç”±åº¦ä¸º$m$çš„$\chi^2$åˆ†å¸ƒ
\end{block}
\end{frame}


\begin{frame}[fragile]{çº¯éšæœºæ€§æ£€éªŒâ€”â€”$LB$ç»Ÿè®¡é‡}
åœ¨å®é™…åº”ç”¨ä¸­ï¼Œäººä»¬å‘ç°$Q$ç»Ÿè®¡é‡åœ¨å¤§æ ·æœ¬åœºåˆ(è§‚æµ‹æœŸ æ•°$n$ å¾ˆå¤§çš„åœºåˆ)æ£€éªŒæ•ˆæœ å¾ˆå¥½, ä½†åœ¨å°æ ·æœ¬åœºåˆä¸å¤ªç²¾ç¡®ã€‚ä¸ºäº†å¼¥è¡¥è¿™ä¸€ç¼ºé™·ï¼Œ åˆæ¨å¯¼å‡ºäº†$LB$(Ljung-Box)
ç»Ÿè®¡é‡
\[LB=n(n+2) \sum^m_{k=1}\frac{\hat \rho^2_k }{n-k} \mathop{\sim}^{\rm asy.} \chi^2(m)\]
\begin{block}{è¯´æ˜ï¼š}
    å®é™…ä¸Š $LB$ ç»Ÿè®¡é‡å°±æ˜¯$Q$ç»Ÿè®¡é‡çš„ä¿®æ­£ï¼Œæ‰€ä»¥äººä»¬ ä¹ æƒ¯æŠŠå®ƒä»¬ç»Ÿç§°ä¸º $Q$ ç»Ÿè®¡é‡ï¼Œåˆ†åˆ«è®°ä½œ$Q_{BP}$å’Œ$Q_{LB}$ç»Ÿè®¡é‡
\end{block}
\end{frame}


\begin{frame}[fragile]{ç»Ÿè®¡é‡çš„æ£€éªŒ}
\begin{itemize}
    \item åŸå‡è®¾$H_0$ï¼šæ»åæœŸ$\le m$çš„åºåˆ—å€¼ä¹‹é—´ç›¸äº’ç‹¬ç«‹
    \item å¤‡æ‹©å‡è®¾$H_1$ï¼šæ»åæœŸ$\le m$çš„åºåˆ—å€¼ä¹‹é—´æœ‰ç›¸å…³æ€§
\end{itemize}

pythonä¸­çš„\verb|statsmodels|æ¨¡å—ä¸­çš„\verb|acorr_ljungbox|å‡½æ•°å¯ç”¨äº$Q$ç»Ÿè®¡é‡å’Œ$LB$ç»Ÿè®¡é‡è®¡ç®—
\begin{lstlisting}
from statsmodels.stats.diagnostic import acorr_ljungbox
acorr_ljungbox(x, lags=None, boxpierce=False)
\end{lstlisting}
\begin{itemize}
    \item \verb|x| å¾…æ£€éªŒçš„éšæœºåºåˆ—;
    \item \verb|lag| æ»åé˜¶æ•°ï¼Œä¸€èˆ¬ä¸ºæ•´æ•°å€¼;
    \item \verb|boxpierce| é»˜è®¤ä¸è¿”å› $Q$ç»Ÿè®¡é‡çš„ç»“æœ
\end{itemize}

\end{frame}


\begin{frame}[fragile]{ç»Ÿè®¡é‡çš„æ£€éªŒç»“æœè§£è¯»}
\begin{lstlisting}
from statsmodels.stats.diagnostic import acorr_ljungbox
Q_test = acorr_ljungbox(x, lags=None, boxpierce=True)
print(Q_test)
\end{lstlisting}
è¾“å‡ºç»“æœä»¥å…ƒç»„å½¢å¼å±•ç°ï¼šç¬¬ä¸€ä¸ªå€¼è¡¨ç¤º$LB$ç»Ÿè®¡é‡çš„å–å€¼ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯å¯¹åº”çš„$p$å€¼ï¼›è‹¥\verb|boxpierce=True|ï¼Œåˆ™å…ƒç»„ä¼šæœ‰å››ä¸ªå…ƒç´ ï¼Œå‰ä¸¤ä¸ªå€¼çš„å«ä¹‰åŒä¸Šï¼Œç¬¬ä¸‰ä¸ªå€¼æ˜¯$Q$ç»Ÿè®¡é‡å–å€¼ï¼Œç¬¬å››ä¸ªæ˜¯å¯¹åº”çš„$p$å€¼
\end{frame}

\section{æ—¶é—´åºåˆ—å»ºæ¨¡}
\subsection{å¹³ç¨³åŒ–å¤„ç†}
\begin{frame}[fragile]{å¹³ç¨³åŒ–å¤„ç†}
å¯¹äºå…·æœ‰è¶‹åŠ¿çš„éå¹³ç¨³æ—¶é—´åºåˆ—æ¥è¯´ï¼Œå·®åˆ†(difference)æ˜¯å»é™¤éå¹³ç¨³æ€§çš„æœ€ä¾¿æ·å·¥å…·

å·®åˆ†å°±æ˜¯åºåˆ—ä¸­ç›¸é‚»ä¸¤ä¸ªæ•°ä¹‹é—´çš„å˜åŒ–é‡ã€‚è®°åºåˆ—ä¸º$X_n=\{x_1,x_2,\ldots,x_n\}$ï¼Œåˆ™ï¼š
\[\Delta x_t=x_t-x_{t-1}\]

\begin{center}
\begin{tikzpicture}
\node [fill=cyan!60!white, circle] (A) at (0,0) {$X_n$};
\node [fill=cyan!40!white,circle ] (B) at (3,0) {$\Delta x$};
\node [fill=cyan!20!white,circle ] (C) at (6,0) {$\Delta_2 x$};
\node  (D) at (8,0) {$\cdots$};
\draw[->, color=magenta, thick](A)--node[above]{ä¸€é˜¶å·®åˆ†}(B);
\draw[->, color=magenta, thick](B)--node[above]{ä¸€é˜¶å·®åˆ†}(C);
\draw[->, color=magenta, thick](C)--(D);

\end{tikzpicture}
\end{center}

\end{frame}


\begin{frame}[fragile]{æ—¶é—´åºåˆ—çš„å·®åˆ†}
Pythonçš„Pandasåº“ä¸­ï¼Œ\verb|.diff|æ–¹æ³•å¯ç”¨æ¥è¿›è¡Œæ—¶é—´åºåˆ—çš„å·®åˆ†
\begin{lstlisting}
    df.diff(periods=1, axis=0)
\end{lstlisting}
\begin{itemize}
    \item \verb|df|ä¸ºDataframe æˆ–è€…Seriesç±»å‹çš„æ•°æ®
    \item \verb|periods| å·®åˆ†çš„é˜¶æ•°ï¼Œè¾“å…¥å€¼ä¸ºæ•´æ•°å€¼ï¼Œé»˜è®¤å€¼ä¸º1
    \item \verb|axis| ç§»åŠ¨çš„æ–¹å‘ï¼Œé»˜è®¤æŒ‰åˆ—å·®åˆ†ï¼›é€‰æ‹©\verb|1/'columns'| æŒ‰è¡Œå·®åˆ†
\end{itemize}

\begin{block}{è¯´æ˜ï¼š}
    å·®åˆ†åï¼Œå› åºåˆ—é¦–ä¸ªæ•°å€¼ç¼ºä¹å·®åˆ†å¯¹è±¡ï¼Œä¼šå¯¼è‡´å·®åˆ†åçš„åºåˆ—é¦–ä½æ•°å€¼ç¼ºå¤±ï¼Œå¯ç”¨\verb|dropna|å‡½æ•°è¿›è¡Œåˆ é™¤
\end{block}
\end{frame}

\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šå¯¹å¹³å®‰é“¶è¡Œæ”¶ç›˜ä»·çš„å·®åˆ†åºåˆ—è¿›è¡Œå¹³ç¨³æ€§æ£€éªŒ}
\begin{lstlisting}
import pandas as pd
import numpy as np
from statsmodels.tsa.stattools import adfuller
# dataä¸ºå¹³å®‰é“¶è¡Œæ•°æ®ï¼Œå…¶ä¸­åŒ…å«æ”¶ç›˜ä»·å’Œæ”¶ç›Šç‡ä¸¤åˆ—æ•°æ®
# å¯¹æ”¶ç›˜ä»·è¿›è¡Œä¸€é˜¶å·®åˆ†ï¼Œå¹¶å»æ‰ç¼ºå¤±å€¼
data_diff1 = data['æ”¶ç›˜ä»·'].diff(1).dropna() 
dftest = adfuller(data_diff1) # å¹³ç¨³æ€§æ£€éªŒ
print(dftest)
\end{lstlisting}
\end{frame}


\subsection{ARMAæ¨¡å‹}
\begin{frame}[fragile]{ARMAæ¨¡å‹}
ARMAæ¨¡å‹ï¼ˆAutoRegression Moving Averageï¼‰å…¨
ç§°æ˜¯è‡ªå›å½’ç§»åŠ¨å¹³å‡æ¨¡å‹ï¼Œæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ‹Ÿåˆå¹³ç¨³æ—¶
é—´åºåˆ—çš„æ¨¡å‹

\begin{block}{${\rm ARMA}(p,q)$æ¨¡å‹çš„å½¢å¼}
    \[\begin{split}
 x_t&= \varphi_0+\varphi_1x_{t-1}+\cdots +\varphi_p x_{t-p}+\varepsilon_t-\theta_1\varepsilon_{t-1}-\cdots -\theta_q\varepsilon_{t-q}         \\
&=\varphi_0 + \sum_{m=1}^{p}\varphi_m x_{t-m}+\varepsilon_t-\sum_{n=1}^{q}\theta_n\varepsilon_{t-n} 
    \end{split} \]
\end{block}

${\rm ARMA}(p,q)$æ¨¡å‹æœ‰ä¸¤ä¸ªç‰¹ä¾‹ï¼Œåˆ†åˆ«æ˜¯AR$(p)$æ¨¡å‹å’ŒMA$(q)$æ¨¡å‹

\end{frame}


\begin{frame}[fragile]{ARæ¨¡å‹}
    ARæ¨¡å‹åˆç§°ä¸ºè‡ªå›å½’æ¨¡å‹(AutoRegression model)ï¼Œæ˜¯ARMAæ¨¡å‹ä¸­åºåˆ—$x_t$åªå—å†å²è§‚æµ‹å€¼å½±å“ï¼Œè€Œä¸å—å†å²éšæœºæ‰°åŠ¨å› ç´ å½±å“çš„ç‰¹ä¾‹ï¼Œå³ ${\rm ARMA}(p,q)$æ¨¡å‹ä¸­$q=0$æ—¶çš„æƒ…å†µ
    \[\begin{split}
x_t&= \varphi_0+\varphi_1x_{t-1}+\cdots +\varphi_p x_{t-p}+\varepsilon_t   \\
&=\varphi_0 + \sum_{m=1}^{p}\varphi_m x_{t-m}+\varepsilon_t
    \end{split} \]
å…¶ä¸­ï¼š$\varphi_p\ne 0$ï¼Œ$\varepsilon_t$æ˜¯éšæœºç™½å™ªå£°åºåˆ—ï¼Œä¸”ä¸$t$æ—¶åˆ»ä¹‹å‰çš„åºåˆ—å€¼æ— å…³
\end{frame}

\begin{frame}[fragile]{MAæ¨¡å‹}
    MAæ¨¡å‹åˆç§°ä¸ºç§»åŠ¨å¹³å‡æ¨¡å‹(Moving Average model)ï¼Œæ˜¯ARMAæ¨¡å‹ä¸­åºåˆ—$x_t$çš„å–å€¼åœ¨å‡å€¼é™„è¿‘ï¼Œåªå—å†å²è§‚æµ‹å€¼éšæœºæ‰°åŠ¨å› ç´ çš„å½±å“ï¼Œè€Œä¸å†å²è§‚æµ‹å€¼æ— å…³çš„ç‰¹ä¾‹ï¼Œå³ ${\rm ARMA}(p,q)$æ¨¡å‹ä¸­$p=0$æ—¶çš„æƒ…å†µ
    \[\begin{split}
 x_t&= \mu+\varepsilon_t-\theta_1\varepsilon_{t-1}-\cdots -\theta_q\varepsilon_{t-q}         \\
&=\mu+\varepsilon_t-\sum_{n=1}^{q}\theta_n\varepsilon_{t-n} 
    \end{split} \]
å…¶ä¸­ï¼š$\theta_q\ne 0$ï¼Œ$\varepsilon_t$æ˜¯éšæœºç™½å™ªå£°åºåˆ—

\begin{block}{è¯´æ˜ï¼š}
    åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”¨${\rm ARMA}(p,q)$æ¨¡å‹
æ‹Ÿåˆå®é™…æ•°æ®æ—¶ï¼Œ$p$
å’Œ$q$çš„æ•°å€¼å¾ˆå°‘è¶…è¿‡2
\end{block}
\end{frame}


    \subsection{æ—¶é—´åºåˆ—å»ºæ¨¡}
\begin{frame}[fragile]{ééšæœºæ—¶é—´åºåˆ—çš„å»ºæ¨¡è¿‡ç¨‹}
\begin{enumerate}
    \item å°†æ—¶é—´åºåˆ—ä»æŸä¸€æ—¶åˆ»æˆªæ–­åˆ†æˆå†å²æ•°æ®ï¼ˆè®­ç»ƒé›†ï¼‰ï¼›â€œæœªæ¥â€æ•°æ®ï¼ˆæµ‹è¯•é›†ï¼‰
    \item æ¨¡å‹å®šé˜¶ï¼šç”¨è®­ç»ƒé›†æ•°æ®ç¡®å®šå·®åˆ†é˜¶æ•°$d$å’ŒARMAæ¨¡å‹ä¸­çš„$p$ã€$q$å€¼
    \item æ‹ŸåˆARMAæ¨¡å‹ï¼šä½¿ç”¨$p$ã€$q$ã€$d$å€¼ï¼Œæ‹ŸåˆARMAæ¨¡å‹
    \item é¢„æµ‹å¹¶æ£€éªŒï¼šç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œå¹¶
    è®¡ç®—é¢„æµ‹å€¼å’Œæµ‹è¯•é›†ä¸­çœŸå®å€¼çš„æ®‹
    å·®å¹³æ–¹å’Œï¼Œæ£€éªŒæ¨¡å‹çš„æ•ˆæœ
\end{enumerate}
\end{frame}

\begin{frame}[fragile]{æ¨¡å‹å®šé˜¶}
    å¯¹è®­ç»ƒé›†æ•°æ®è¿›è¡Œå¹³ç¨³æ€§æ£€éªŒï¼Œ
    å¦‚æœä¸å¹³ç¨³ï¼Œåˆ™å·®åˆ†è‡³å¹³ç¨³ï¼Œ
    å¹³ç¨³çš„å·®åˆ†é˜¶æ•°å³ä¸º$d$

    ç»˜åˆ¶è®­ç»ƒé›†æ•°æ®çš„è‡ªç›¸å…³å›¾(ACF)å’Œå
    è‡ªç›¸å…³å›¾(PACF)ã€‚å›¾ä¸­æ‚¬å‚çº¿å¿«é€Ÿè¡°å‡
    åˆ°0æˆ–é˜´å½±åŒºåŸŸæ—¶ï¼Œå‰è€…çš„æ¨ªå
    æ ‡ä¸º$q$ï¼Œåè€…çš„æ¨ªåæ ‡ä¸º$p$

    python \verb|pmdarima|åº“ä¸­ï¼Œ\verb|auto.arima|å‡½æ•°å¯ä»¥è‡ªåŠ¨å°è¯•ä¸åŒçš„é˜¶æ•°ç»„åˆå¹¶æŒ‘é€‰å‡ºå¯èƒ½çš„æœ€ä¼˜æ¨¡å‹ï¼Œä»è€Œè‡ª
    åŠ¨å®šé˜¶

\begin{block}{æ³¨æ„ï¼š}
    \verb|pmdarima|åº“ä¸åŒ…å«åœ¨Anacondaç­‰Pythonå¼€å‘å¹³å°ä¸­ï¼Œéœ€è¦å•ç‹¬å®‰è£…ï¼Œè”ç½‘å®‰è£…å‘½ä»¤ä¸ºï¼š
\begin{lstlisting}
    pip install pmdarima
\end{lstlisting}
\end{block}
\end{frame}


\begin{frame}[fragile]{æ¨¡å‹å®šé˜¶(cont.)}
\begin{lstlisting}
import pmdarima as pm
pm.auto_arima(x, d=None, max_p=3, max_q=3, start_p=0, start_q=0, information_criterion='aic', test='adf', m=1, seasonal=True, trace=True)
\end{lstlisting}
\begin{itemize}
    \item \verb|x| éœ€è¦æ‹Ÿåˆçš„æ•°æ®åºåˆ—
    \item \verb|d| æŒ‡å®šå·®åˆ†é˜¶æ•°ï¼Œé»˜è®¤è‡ªåŠ¨è®¡ç®—å·®åˆ†é˜¶æ•°
    \item \verb|start_p|, \verb|max_p| æŒ‡å®šARæ¨¡å‹çš„é˜¶æ•°èŒƒå›´
    \item \verb|start_q|, \verb|max_q| æŒ‡å®šMAæ¨¡å‹çš„é˜¶æ•°èŒƒå›´
    \item \verb|information_criterion| æŒ‡å®šæœ€ä¼˜æ¨¡å‹è¯„åˆ¤æ ‡
    å‡†ï¼ˆä¿¡æ¯å‡†åˆ™ï¼‰ï¼Œé»˜è®¤æ˜¯èµ¤æ± ä¿¡æ¯å‡†åˆ™
\end{itemize}


\end{frame}

\begin{frame}[fragile]{æ¨¡å‹å®šé˜¶(cont.)}
\begin{lstlisting}
import pmdarima as pm
pm.auto_arima(x, d=None, max_p=3, max_q=3, start_p=0, start_q=0, information_criterion='aic', test='adf', m=1, seasonal=True, trace=False)
\end{lstlisting}
\begin{itemize}
    \item \verb|test| é»˜è®¤ä½¿ç”¨ADFæ£€éªŒå·®åˆ†çš„é˜¶æ•°\verb|d|
    \item \verb|m| å­£èŠ‚æ€§å‘¨æœŸé•¿åº¦ï¼Œé»˜è®¤ä¸è€ƒè™‘å‘¨æœŸæ€§ã€‚\verb|m=4|è¡¨ç¤ºå­£åº¦æ•°æ®ï¼›\verb|m=12|è¡¨ç¤ºæœˆåº¦æ•°æ®
    \item \verb|seasonal| é»˜è®¤è€ƒè™‘å­£èŠ‚æ€§ï¼Œå½“\verb|m=1|æ—¶ï¼Œ\verb|seasonal=False|
    \item \verb|trace| é»˜è®¤ä¸æŠ¥å‘Šå°è¯•è¿‡çš„ARIMAæ¨¡å‹ç»“æœ
\end{itemize}


\end{frame}

\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šå¹³å®‰é“¶è¡Œæ”¶ç›˜ä»·æ•°æ®çš„æ¨¡å‹å®šé˜¶}
\begin{lstlisting}
from pmdarima import auto_arima
model = auto_arima(data['æ”¶ç›˜ä»·'], start_p=0, start_q=0, 
        information_criterion='aic', test='adf', max_p=3, 
        max_q=3, m=1, d=None, seasonal=False, trace=True) 
print(model)      # æ˜¾ç¤ºæœ€ä½³æ‹Ÿåˆæ¨¡å‹
\end{lstlisting}

\begin{block}{è¯´æ˜ï¼š}
è¾“å‡ºç»“æœå½“ä¸­æŠ¥å‘Šäº†æ‹Ÿåˆè¿‡ç¨‹ä¸­è€ƒè™‘åˆ°çš„å„ç§ARIMAæ¨¡å‹ï¼Œå¹¶ä¸”é€šè¿‡AICæŒ‡æ ‡ç›´æ¥è·å–äº†æœ€ä¼˜çš„æ‹Ÿåˆæ¨¡å‹
\end{block}
\end{frame}

\begin{frame}[fragile]{æ¨¡å‹æ‹Ÿåˆ}
æ¨¡å‹å®šé˜¶åï¼Œç¡®å®šäº†$p,q,d$çš„å€¼ï¼Œå°†å‚æ•°å’Œåºåˆ—å†å²æ•°æ®ä»£å…¥ARIMAæ¨¡å‹ï¼Œå°±å¯å¯¹æ—¶é—´åºåˆ—è¿›è¡Œæ‹Ÿåˆ

\begin{center}
    \begin{tikzpicture}
\node[fill=cyan!40!white] (A) at (0,0) {å»ºç«‹ä¸€ä¸ªç©ºç™½çš„ARIMAå¯¹è±¡};
\node[fill=green!40!white] (A1) at (0,-1.5) {å°†å‚æ•°å’Œå†å²æ•°æ®ä»£å…¥å¯¹è±¡};
\node[fill=magenta!40!white] (A2) at (0,-3) {é€šè¿‡\texttt{fit}æ–¹æ³•å¯¹æ¨¡
å‹æ‹Ÿåˆæ¿€æ´»};
\draw[->, thick, color=blue](A)--(A1);
\draw[->, thick, color=blue](A1)--(A2);
    \end{tikzpicture}
\end{center}
\end{frame}


\begin{frame}[fragile]{æ¨¡å‹å¯¹è±¡çš„å»ºç«‹åŠæ‹Ÿåˆ}
Pythonçš„\verb|statsmodels|åº“ä¸­ï¼Œ\verb|ARIMA|å‡½æ•°å¯ä»¥ç”¨äºå»ºç«‹æ¨¡å‹å¯¹è±¡
\begin{lstlisting}
from statsmodels.tsa.arima.model import ARIMA
model = ARIMA(endog, order=(p, d, q))
\end{lstlisting}
\begin{itemize}
    \item \verb|endog| å¯é€‰é¡¹ï¼Œè§‚å¯Ÿåˆ°çš„æ—¶é—´åºåˆ—è¿‡ç¨‹
    \item \verb|order| ARMIAæ¨¡å‹çš„é˜¶æ•°ï¼Œé»˜è®¤å€¼ä¸º\verb|(0, 0, 0)|
\end{itemize}

Pythonä¸­ç”¨äºæ¨¡å‹æ‹Ÿåˆçš„å‡½æ•°ä¸º\verb|fit|
\begin{lstlisting}
    results = model.fit()
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{æ¨¡å‹å¯¹è±¡çš„ç»“æœè¾“å‡º}
\begin{lstlisting}
results = model.fit()
print(results.summary()) # è¾“å‡ºæ¨¡å‹çš„æ‹Ÿåˆç»“æœåŠå¯¹åº”çš„å„ç»Ÿè®¡é‡
pred = results.predict()
print(pred)         # è¾“å‡ºæ ¹æ®è®¾å®šçš„æ¨¡å‹äº§ç”Ÿçš„é¢„æµ‹æ•°æ®åºåˆ—
print('RSS: %.4f' %sum((pred- data['æ”¶ç›˜ä»·'])**2))  
# è¾“å‡ºæ¨¡å‹çš„æ®‹å·®å¹³æ–¹å’Œ(RSS)
\end{lstlisting}
\end{frame}


\section{æŠ•èµ„ç»„åˆç›¸å…³æ€§åˆ†æ}
\subsection{æŠ•èµ„ç»„åˆç†è®º}
\begin{frame}[fragile]{æŠ•èµ„ç»„åˆç†è®ºæ¦‚è¿°}
 æŠ•èµ„ç»„åˆæ˜¯ç°ä»£é‡‘èå­¦ç•Œçš„æ ¸
å¿ƒè¯¾é¢˜ä¹‹ä¸€ï¼ŒæŠ•èµ„ç»„åˆçš„æ ¸å¿ƒ
é—®é¢˜æ˜¯ï¼šæŠ•èµ„è€…å¦‚ä½•å°†åˆç†åˆ†
é…è¯åˆ¸èµ„äº§ï¼Œä»¥å®ç°åœ¨æ—¢å®šé£
é™©ä¸‹æ”¶ç›Šæœ€å¤§åŒ–

é©¬ç§‘ç»´èŒ¨(H. Markowitz)ç”¨è¯åˆ¸çš„æœŸæœ›æ”¶ç›Šç‡
æ¥è¡¡é‡æŠ•èµ„çš„æœŸæœ›æ”¶ç›Šæ°´å¹³ï¼Œ
ç”¨æ”¶ç›Šç‡çš„æ–¹å·®æ¥è¡¡é‡æŠ•èµ„çš„
é£é™©ã€‚åœ¨æŠ•èµ„è€…å€¼å…³æ³¨â€œæœŸæœ›
æ”¶ç›Šç‡â€å’Œâ€œæ–¹å·®â€çš„å‰æä¸‹ï¼Œ
æ¨å¯¼å‡ºç»“è®ºï¼šæŠ•èµ„è€…åº”è¯¥é€šè¿‡
åŒæ—¶è´­ä¹°å¤šç§è¯åˆ¸è€Œä¸æ˜¯ä¸€ç§
è¯åˆ¸è¿›è¡Œåˆ†æ•£åŒ–æŠ•èµ„ã€‚å› æ­¤æŠ•
èµ„ç»„åˆç†è®ºé€šå¸¸ä¹Ÿç§°ä¸ºåˆ†æ•£æŠ•
èµ„ç†è®ºï¼Œç®€å•æ¥è¯´å°±æ˜¯â€œä¸æŠŠ
æ‰€æœ‰çš„é¸¡è›‹æ”¾è¿›åŒä¸€ç¯®å­é‡Œâ€
\end{frame}


\begin{frame}[fragile]{é©¬ç§‘ç»´èŒ¨æŠ•èµ„ç»„åˆç†è®ºåŸºæœ¬å‡è®¾}
\begin{itemize}
    \item æŠ•èµ„è€…æ˜¯é£é™©è§„é¿çš„ï¼Œè¿½æ±‚æœŸæœ›æ•ˆç”¨æœ€å¤§åŒ–ï¼›
    \item æŠ•èµ„è€…æ ¹æ®æ”¶ç›Šç‡çš„æœŸæœ›å€¼ä¸æ–¹å·®æ¥é€‰æ‹©æŠ•èµ„ç»„
    åˆï¼›
    \item æ‰€æœ‰æŠ•èµ„è€…å¤„äºåŒä¸€å•æœŸæŠ•èµ„æœŸã€‚
\end{itemize}

åœ¨æ»¡è¶³ä»¥ä¸Šå‡è®¾çš„æ¡ä»¶ä¸‹ï¼Œä»¥èµ„äº§æƒé‡$w_i$ä¸ºå˜é‡ï¼Œåœ¨
æœŸæœ›æ”¶ç›Šé™åˆ¶æ¡ä»¶ä¸‹ï¼Œæ±‚è§£ä½¿å¾—æŠ•èµ„ç»„åˆé£é™©${\rm Var}(r_p)$æœ€å°
æ—¶çš„æœ€ä¼˜æŠ•èµ„æ¯”ä¾‹ï¼Œå…¶ä¼˜åŒ–æ¨¡å‹çš„æ•°å­¦å…¬å¼ä¸ºï¼š
\[\begin{split}
    \min{\rm Var}(r_p)&=\sum^n_{i=1}\sum^n_{j=1} w_iw_j {\rm Cov}(r_i,r_j)\\
    {\rm s.t.}\qquad \E(r_p)&=\sum^n_{i=1} w_ir_i,\quad \sum^n_{i=1} w_i=1
\end{split} \]

\end{frame}



\begin{frame}[fragile]{æŠ•èµ„ç»„åˆç†è®º(cont.)}
    æŠ•èµ„ç»„åˆåœ¨å®é™…ä¼˜åŒ–è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨å¾ˆ
    å¤šä¸­èµ„é‡‘åˆ†é…æ–¹æ¡ˆï¼Œéœ€è¦é€‰æ‹©é£é™©
    ï¼ˆæ–¹å·®ï¼‰æœ€å°çš„æ–¹æ¡ˆã€‚ç„¶ååœ¨ä¸åŒæœŸ
    æœ›æ”¶ç›Šæ°´å¹³ä¸‹ï¼Œå¾—åˆ°ç›¸åº”çš„ä½¿æ–¹å·®æœ€
    å°çš„èµ„äº§åˆ†é…æ–¹æ¡ˆï¼Œè¿™äº›è§£æ„æˆäº†æœ€
    å°æ–¹å·®ç»„åˆï¼ˆæœ‰æ•ˆç»„åˆï¼‰
    
    æœ‰æ•ˆç»„åˆ
    çš„æ”¶ç›ŠæœŸæœ›å’Œç›¸åº”çš„æœ€å°æ–¹å·®å½¢æˆçš„
    æ›²çº¿ï¼Œå°±æ˜¯æœ‰æ•ˆç»„åˆæŠ•èµ„çš„å‰æ²¿
    ï¼ˆefficient frontierï¼‰
\end{frame}


\subsection{çš®å°”é€Šç›¸å…³ç³»æ•°}
\begin{frame}[fragile]{çš®å°”é€Šç›¸å…³ç³»æ•°çš„æ¦‚å¿µ}
çš®å°”é€Šç›¸å…³ç³»æ•°ï¼ˆPearson
    correlation coefficientï¼‰ç”¨äºåº¦
    é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„{\color{red}çº¿æ€§ç›¸å…³æ€§}çš„
    æŒ‡æ ‡
\[\rho_{X,Y}=\frac{{\rm Cov}(X,Y)}{\sigma_X\sigma_Y}=\frac{\E[(X-\mu_X)(Y-\mu_Y)]}{\sigma_X\sigma_Y} \]
    ä¸¤ä¸ªåºåˆ—ä¹‹é—´çš„ç›¸å…³ç³»æ•°æ˜¯å…¶åæ–¹å·®
    å’Œæ ‡å‡†å·®çš„å•†ï¼Œå…¶å–å€¼èŒƒå›´ä¸º$[âˆ’1,1]$

\begin{block}{è¯´æ˜ï¼š}
\begin{itemize}
    \item $\rho_{X,Y}=1$ï¼Œå­˜åœ¨ç¡®åˆ‡çš„çº¿æ€§æ­£ç›¸å…³ï¼›
    \item $\rho_{X,Y}=0$ï¼Œä¸å­˜åœ¨ä»»ä½•çº¿æ€§ç›¸å…³æ€§ï¼›
    \item  $\rho_{X,Y}=-1$ï¼Œå­˜åœ¨ç¡®åˆ‡çš„çº¿æ€§è´Ÿç›¸å…³ã€‚
\end{itemize}
\end{block}
\end{frame}


\begin{frame}[fragile]{çš®å°”é€Šç›¸å…³ç³»æ•°çš„è®¡ç®—}
    Pythonçš„Pandasåº“ï¼Œå¯è®¡ç®—åˆ—çš„æˆå¯¹ç›¸å…³æ€§å¹¶ç”ŸæˆçŸ©é˜µ
\begin{lstlisting}
    df.corr(method='pearson', min_periods=1)
\end{lstlisting}
\begin{itemize}
    \item \verb|method| é€‰æ‹©ä½¿ç”¨å“ªç§ç›¸å…³åˆ†ææ–¹æ³•ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨çš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸º\verb|'kendall'|æˆ–\verb|'spearman'|
    \item \verb|min_periods| ä»£è¡¨æ¯ä¸ªâ€œåˆ—å¯¹â€æŒ‡å®šæ‰€éœ€çš„æœ€å°éNAè§‚æµ‹æ•°ï¼Œä»¥ä¾¿
    è·å¾—æœ‰æ•ˆç»“æœ
\end{itemize}

\begin{block}{è¯´æ˜ï¼š}
    è¯¥å‡½æ•°ä¼šè‡ªåŠ¨ä»è®¡ç®—ä¸­æ’é™¤\verb|NA|å’Œ\verb|null|
\end{block}
\end{frame}

\begin{frame}[fragile]{ç›¸å…³ç³»æ•°çš„å¯è§†åŒ–}
    å¸¸ç”¨seabornåº“ä¸­çš„\verb|heatmap|å‡½æ•°ï¼Œæ¥ç»˜åˆ¶çƒ­å›¾(heat map)ä»¥ä¾¿äºè§‚å¯Ÿç›¸å…³çŸ©é˜µ
\begin{lstlisting}
from seaborn import heatmap
heatmap(data, cmap=None, annot=False, linewidths=0, annot_kws=None)
\end{lstlisting}
\begin{itemize}
    \item \verb|data| è¦æ˜¾ç¤ºçš„æ•°æ®
    \item \verb|cmap| é€‰å¡«é¡¹ï¼Œ\verb|matplotlib|çš„colormapåç§°æˆ–é¢œè‰²å¯¹è±¡
    \item \verb|annot| é€‰å¡«é¡¹ï¼Œé»˜è®¤ä¸åœ¨çƒ­å›¾çš„æ¯ä¸ªæ–¹æ ¼ä¸­å†™å…¥æ•°æ®
    \item \verb|linewidths| çƒ­å›¾çŸ©é˜µä¹‹é—´çš„é—´éš”å¤§å°ï¼Œé»˜è®¤ä¸º0
    \item \verb|annot_kws| çƒ­å›¾ä¸Šæ¯ä¸ªæ–¹æ ¼æ•°æ®å­—ä½“çš„å¤§å°
\end{itemize}

\end{frame}



\begin{frame}[fragile]{åæ–¹å·®çŸ©é˜µçš„è®¡ç®—}
    ç›¸å…³ç³»æ•°åªååº”äº†è¯åˆ¸ä¹‹é—´çš„çº¿æ€§å…³ç³»ï¼Œ
    å³è‚¡ç¥¨ä¹‹é—´æ¯æ¬¡æ¶¨è·Œæ—¶çš„ç±»ä¼¼ç¨‹åº¦ï¼Œä½†
    å¹¶ä¸èƒ½å‘Šè¯‰è‚¡ç¥¨ä¹‹é—´çš„æ³¢åŠ¨ï¼ˆå˜åŒ–å¹…åº¦ï¼‰
    æƒ…å†µï¼Œè€Œåæ–¹å·®çŸ©é˜µåˆ™åŒ…å«è¿™ä¸€ä¿¡æ¯

    å½“åæ–¹å·®ä¸ºæ­£æ•°æ—¶ï¼Œä»£è¡¨è‚¡ç¥¨éƒ½åŒæ–¹å‘
    åç¦»å„è‡ªå‡å€¼ï¼Œå¯å¸®åŠ©äº†è§£åˆ°è‚¡ç¥¨æ­¤æ—¶å˜
    åŠ¨å¹…åº¦è·ç¦»å…¶å¹³å‡å¹…åº¦æœ‰å¤šå¤§

    Pythonçš„Pandasåº“ï¼Œå¯è®¡ç®—åˆ—çš„æˆå¯¹åæ–¹å·®å¹¶ç”Ÿæˆåæ–¹å·®çŸ©é˜µ
\begin{lstlisting}
    df.cov(min_periods=None)
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{ç›¸å…³ç³»æ•°çš„æ˜¾è‘—æ€§æ£€éªŒ}
    çš®å°”é€Šç›¸å…³ç³»æ•°å¯ä»¥é‡åŒ–ä¸¤åªè‚¡ç¥¨é—´çš„ç›¸å…³å…³ç³»
    å¤§å°ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥è€ƒè™‘è¿™ç§ç›¸å…³å…³ç³»æ˜¯å¦åœ¨ç»Ÿ
    è®¡ä¸Šæ˜¾è‘—
\begin{itemize}
    \item åŸå‡è®¾ï¼šä¸¤åªåºåˆ—çš„çº¿æ€§ç›¸å…³å…³ç³»ä¸æ˜¾è‘—ï¼›
    \item å¤‡æ‹©å‡è®¾ï¼šä¸¤åªåºåˆ—çš„çº¿æ€§ç›¸å…³å…³ç³»æ˜¾è‘—ã€‚
\end{itemize}
å¦‚æœè®¡ç®—å‡ºçš„$p$-valueå€¼æ¥è¿‘äºé›¶ï¼Œè¡¨æ˜æ¥å—å‡
è®¾çš„æ¦‚ç‡ä¸å¤§ï¼Œåˆ™æ‹’ç»åŸå‡è®¾ï¼Œè®¤ä¸ºä¸¤åªåºåˆ—çš„
çº¿æ€§ç›¸å…³å…³ç³»æ˜¾è‘—ã€‚
\end{frame}


\begin{frame}[fragile]{ä¸¾ä¾‹ï¼šåæ–¹å·®çŸ©é˜µçš„è®¡ç®—}
ä»¥15æ”¯è‚¡ç¥¨çš„æ—¥æ”¶ç›Šç‡æ•°æ®ä¸ºä¾‹ï¼Œè®¡ç®—åæ–¹å·®çŸ©é˜µå¹¶ç”»å‡ºçƒ­å›¾
\begin{lstlisting}
import pandas as pd
cov_mat = stockreturns.cov()
print(round(cov_mat, 5))  # ä¿ç•™äº”ä½å°æ•°ï¼Œä¹Ÿå¯ä»¥å†™æˆä»¥ä¸‹å½¢å¼ï¼š
print(cov_mat.round(5))
# ç”»çƒ­å›¾
import matplotlib.pyplot as plt
from seaborn import heatmap
heatmap(cov_mat.round(3), cmap='rainbow', linewidth=2, 
        annot=True)
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{ç›¸å…³ç³»æ•°çš„æ˜¾è‘—æ€§æ£€éªŒ(cont.)}
åœ¨Pythonçš„scipyåº“ä¸­ï¼Œ\verb|pearsonr|å‡½æ•°å¯ä»¥è®¡ç®—ç›¸å…³ç³»æ•°ï¼Œå¹¶è·å¾—åŒè¾¹æ£€éªŒçš„$p$å€¼
\begin{lstlisting}
from scipy.stats import pearsonr
pearsonr(x, y)
\end{lstlisting}

è¾“å‡ºçš„ç»“æœæ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå€¼è¡¨ç¤ºçš®å°”é€Šç›¸å…³ç³»æ•°ï¼Œç¬¬äºŒä¸ªå€¼æ˜¯å¯¹åº”çš„$p$å€¼
\end{frame}


\subsection{ç­‰æƒé‡æŠ•èµ„ç»„åˆ}
\begin{frame}[fragile]{ç­‰æƒé‡æŠ•èµ„ç»„åˆ}
    æœ€å®¹æ˜“ç†è§£çš„æŠ•èµ„ç­–ç•¥ï¼š
\begin{itemize}
    \item æŠ•èµ„æ–¹æ¡ˆé‡Œèµ„é‡‘å°†å‡åˆ†åˆ°æ¯æ”¯è¯åˆ¸é‡Œ;
    \item æ‰€æœ‰è¯åˆ¸çš„æƒé‡éƒ½ç›¸ç­‰
    \[w_1=w_2=\cdots=w_n=\frac{1}{n}\]
\end{itemize}    

æ„é€ ä¸€ä¸ªç­‰æƒçš„æƒé‡åºåˆ—ï¼Œéœ€è¦åœ¨numpyåº“ä¸­ä½¿ç”¨\verb|repeat|å‡½æ•°
\begin{lstlisting}
    numpy.repeat(a, repeats, axis=None)
\end{lstlisting}
\begin{itemize}
    \item \verb|a| è¾“å…¥éœ€è¦é‡å¤çš„å…ƒç´ æˆ–æ•°ç»„
    \item \verb|repeats| æ¯ä¸ªå…ƒç´ çš„é‡å¤æ¬¡æ•°
\end{itemize}
\end{frame}


\begin{frame}[fragile]{ç­‰æƒé‡æŠ•èµ„ç»„åˆæƒé‡åºåˆ—çš„æ„é€ }
    è®©15æ”¯è‚¡ç¥¨çš„æ¯æ”¯ç»„åˆæƒé‡ä¸º1/15ï¼Œæ„é€ æƒé‡åºåˆ—
\begin{lstlisting}
import numpy as np
numstocks = 15  
portfolio_weights = np.repeat(1/numstocks, numstocks) 
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]{æ„é€ ç­‰æƒè¯åˆ¸ç»„åˆ}
\begin{lstlisting}
# åœ¨15æ”¯è‚¡ç¥¨æ”¶ç›Šç‡çŸ©é˜µä¸­ï¼ŒæŒ‰åˆ—ä¾æ¬¡ä¹˜ä»¥æƒé‡ç³»æ•° 
WeightedReturns = stockreturns.mul(portfolio_weights, axis=1) 
# å°†åŠ æƒåçš„15æ”¯è‚¡ç¥¨æ”¶ç›Šç‡è¿›è¡Œç›¸åŠ ï¼Œæ„é€ æŠ•èµ„ç»„åˆåºåˆ—
portfolio_ew = WeightedReturns.sum(axis=1) 
print(portfolio_ew)
\end{lstlisting}
\begin{center}
\begin{tikzpicture}[scale=.4]
\foreach \x in {1,2,...,7}
   \foreach \y in {1,2,...,5}
    \node[fill=cyan!40!white] at (\x,\y){\quad};
\draw[->,thick, red](1,5.75)--node[above]{\texttt{axis=1}}(7,5.75);
\draw[->,thick, blue](.25,5)--node[left]{\texttt{axis=0}}(.25,1);
\end{tikzpicture}
\end{center}
\end{frame}


\begin{frame}[fragile]{è¯åˆ¸ç»„åˆçš„ç‰¹å¾}
åªçœ‹æ—¥æ”¶ç›Šç‡ï¼Œå¾ˆéš¾è§‚å¯Ÿåˆ°æŠ•èµ„ç»„åˆçš„é•¿æœŸæ”¶ç›Šï¼Œè¦ çŸ¥é“æŠ•èµ„ä¸­ä¸ŠæœŸæœªçš„æœ¬åˆ©å’Œæ˜¯ä½œä¸ºä¸‹ä¸€æœŸçš„æœ¬é‡‘ï¼Œä¹Ÿ å°±æ˜¯é€šä¿—ä¸Šè¯´çš„â€œåˆ©æ»šåˆ©â€ã€‚

å®¢æˆ·å®é™…ä¸Šè·å–çš„æ”¶ç›Šç‡æ˜¯ç´¯ä¹˜æ”¶ç›Šç‡
\[\begin{split}
    return &= (1+r_1)(1+r_2)\cdots(1+r_n)-1\\
&=\prod^{n}_{i=1}(1+r_i) -1
\end{split} \]

\end{frame}




\begin{frame}[fragile]{ç´¯ä¹˜}
    Pythonä¸­\verb|cumprod|å‡½æ•°å¯ä»¥å®ç°æ”¶ç›Šç‡çš„ç´¯ä¹˜ï¼ˆ{\color{red}cum}ulative {\color{red}prod}uctï¼‰è®¡ç®—

\begin{lstlisting}
    df.cumprod(axis=0, skipna=True)
\end{lstlisting}

\begin{itemize}
    \item \verb|axis| é»˜è®¤æŒ‰è¡Œè®¡ç®—ï¼Œ \verb|axis=1|ä»£è¡¨å¯¹åˆ—è®¡ç®—
    \item \verb|skipna| é»˜è®¤è®¡ç®—æ—¶è‡ªåŠ¨å¿½ç•¥\verb|NA|å’Œ\verb|null|
\end{itemize}
è¿”å›ç´¯ä¹˜æ„æˆçš„Seriesæˆ–DataFrame

\end{frame}



\begin{frame}[fragile]{å¯¹æŠ•èµ„ç»„åˆçš„æ—¥æ”¶ç›Šç‡è®¡ç®—ç´¯ä¹˜æ”¶ç›Šç‡å¹¶ç»˜å›¾}
\begin{lstlisting}
import pandas as pd
import matplotlib.pyplot as plt
plt.figure(figsize=(6,5), dpi=100)      # è®¾ç½®ç”»å¸ƒå°ºå¯¸åŠæ¸…æ™°åº¦
Cum_Returns=((1+portfolio_ew).cumprod()-1) 
Cum_Returns.plot(label='equally-weighted portfolio')  
#  æˆ–è€…å†™æˆä»¥ä¸‹å½¢å¼ï¼š
plt.plot(Cum_Returns, label='equally-weighted portfolio')
plt.legend() # æ·»åŠ å›¾ä¾‹ï¼Œæ–‡å­—æ¥è‡ªäºplotä¸­çš„label
plt.show()
\end{lstlisting}
\end{frame}


\end{document}